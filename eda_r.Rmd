---
title: "EDA con R"
output: github_document
editor_options: 
  chunk_output_type: console
---


## Preliminares

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(magrittr)
library(skimr)
library(janitor)
library(rstatix)
library(fdth)
library(corrplot)
library(ggplot2)
```

### Importacion

```{r}
data <- read_csv('Data/Churn_Modelling.csv')
```
#### Verificar y corregir columnas

```{r}
data %>% glimpse
```

```{r}
data %>% 
  mutate(
    HasCrCard= factor(HasCrCard, levels= c(0, 1), 
                             labels= c('no', 'si') ),
    IsActiveMember= factor(IsActiveMember, levels= c(0, 1), 
                             labels= c('no', 'si') ),
    Exited= factor(Exited, levels=c(0,1), labels= c('no','si'))
    
  ) ->
  data
```

```{r}
data %>% glimpse
```


# EDA

## EDA Univariado


### Todas las variables
```{r}
skim( data)
```



### Variables con posibles outliers

```{r}
data %>% 
  reframe( 
    tibble(
      Descrip= c('P_0', 'P_02', 'P_25', 'P_50' , 'P_75', 'P_98', 'P_100') ,
      Valor= quantile( Balance, c(0, 0.2, 0.25, 0.50 ,0.75, 0.98, 1), na.rm= T)
    )
    )
```

```{r}
data %>% 
  ggplot( aes(x=1, y= Balance)) +
  geom_boxplot() + 
  coord_flip() +
  theme_bw()
```

```{r}
data %>% 
  reframe( 
    tibble(
      Descrip= c('P_0', 'P_02', 'P_25', 'P_50' , 'P_75', 'P_97', 'P_100') ,
      Valor= quantile( CreditScore, c(0, 0.2, 0.25, 0.50 ,0.75, 0.97, 1), na.rm= T)
    )
    )
```

### Balanceo


```{r}
data %>% 
  group_by(Exited) %>% 
  count()
```

```{r}
data %>% 
  group_by(Exited) %>% 
  count() %>% 
  ggplot( aes(x= Exited, y= n)) +
  geom_col()
```


## EDA Multivariado

### Room 11

#### CreditScore vs Exited

**Tabla**
```{r}

```

**Grafico**
```{r}

```

**Interpretacion**





### Room 14






### Room 15






### Room 16
```{r}
data %>% ggplot(aes(x=NumOfProducts,y=Balance)) + 
  geom_point()
```


```{r}
data %>% ggplot(aes(x=NumOfProducts,y=Balance)) + 
  geom_point()

```


```{r}
data %>% ggplot(aes(x=Exited,y=Age)) + geom_boxplot()
```

```{r}
# realizar una prueba Anova

# Variables cualitativas
data %>%
  tabyl (HasCrCard,Exited) %>% 
  adorn_totals(c("row"))%>% adorn_percentages("col") %>% 
  adorn_pct_formatting(digits = 2)

```


```{r}
#3 variables
data %>% ggplot(aes(x=HasCrCard,y=Age, color=Exited)) + 
  geom_boxplot()

```



